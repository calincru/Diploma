\chapter{Design and implementation}\label{chapter:design}

\section{Overview}

\section{The model}
\subsection{User-defined chains}
\subsection{Routing decision}
\subsection{Network Address Translation}
\subsection{Connection tracking}

\section{Extensions}
\subsection{TCP and UDP}
\subsection{MARK and CONNMARK}

\section{Limitations}
\subsection{The local process}
\subsection{The RELATED connection state}
